

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Coordinates and fragments &mdash; Yggdrasill 0.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/my_theme.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Job Types" href="job-types.html" />
    <link rel="prev" title="Basic usage" href="basics.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: white" >
          

          
            <a href="index.html" class="icon icon-home"> Yggdrasill
          

          
            
            <img src="_static/yggdrasill-test-for-ascii.png" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
<li class="toctree-l1"><a class="reference internal" href="basics.html">Basic usage</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Coordinates and fragments</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-modifying-fragment-objects">Creating/modifying fragment objects</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#direct-creation-of-fragment-from-coordinates">Direct creation of fragment from coordinates</a></li>
<li class="toctree-l3"><a class="reference internal" href="#adding-coordinates-to-empty-object">Adding coordinates to empty object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#replace-coordinates-of-object">Replace coordinates of object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#delete-coordinates-of-object">Delete coordinates of object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#calculate-connectivity-of-fragment-object">Calculate connectivity of fragment object</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inspect-defined-fragment-objects">Inspect defined fragment objects</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="job-types.html">Job Types</a></li>
<li class="toctree-l1"><a class="reference internal" href="QM-interfaces.html">QM Interfaces</a></li>
<li class="toctree-l1"><a class="reference internal" href="orca-interface.html">ORCA Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="TODO.html">Things to todo</a></li>
<li class="toctree-l1"><a class="reference internal" href="yggdrasill-classes.html">Yggdrasill object classes</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Yggdrasill</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Coordinates and fragments</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/coordinate-input.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="coordinates-and-fragments">
<h1>Coordinates and fragments<a class="headerlink" href="#coordinates-and-fragments" title="Permalink to this headline">¶</a></h1>
<div class="section" id="creating-modifying-fragment-objects">
<h2>Creating/modifying fragment objects<a class="headerlink" href="#creating-modifying-fragment-objects" title="Permalink to this headline">¶</a></h2>
<p>Fragments in Yggdrasill are Python objects containing basic information about a molecule. You can create as many fragment objects
as you want. A typical fragment will contain at least Cartesian coordinates about a molecule and the elemental information.
Fragments can be created in multiple ways but will behave the same after creation.</p>
<p>Fragments are Python objects created from the Yggdrasill <em>Fragment</em> object class.
See XXFragment-class-page-linkXX for an overview of all Fragment class attributes and functions.</p>
<div class="section" id="direct-creation-of-fragment-from-coordinates">
<h3>Direct creation of fragment from coordinates<a class="headerlink" href="#direct-creation-of-fragment-from-coordinates" title="Permalink to this headline">¶</a></h3>
<p><em>From string</em></p>
<p>First define multi-line string (called fragcoords here) with element and coordinates (Å) separated by space:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fragcoords</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">H 0.0 0.0 0.0</span>
<span class="s2">F 0.0 0.0 1.0</span>
<span class="s2">&quot;&quot;&quot;</span>
</pre></div>
</div>
<p>Then define object (here called <strong>HF_frag</strong>) of class <em>Fragment</em> by passing the coordinates to <em>coordsstring</em>, using coordinates from the string “fragcoords”.
The <em>Fragment</em> class is an Yggdrasill class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HF_frag</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">coordsstring</span><span class="o">=</span><span class="n">fragcoords</span><span class="p">)</span>
</pre></div>
</div>
<p><em>From list</em></p>
<p>Another way is if you have lists of coordinates and element information already available.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">elems</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Cl&#39;</span><span class="p">]</span>
<span class="n">coords</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]]</span>
<span class="n">HCl_frag</span><span class="o">=</span><span class="n">Fragment</span><span class="p">(</span><span class="n">elems</span><span class="o">=</span><span class="n">elems</span><span class="p">,</span><span class="n">coords</span><span class="o">=</span><span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
<p><em>From external XYZ file</em></p>
<p>Perhaps most convenient is to define the fragment directly from reading an XYZ-file (that exists in the same directory as the script):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HI_frag</span> <span class="o">=</span> <span class="n">Fragment</span><span class="p">(</span><span class="n">xyzfile</span><span class="o">=</span><span class="s2">&quot;hi.xyz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="adding-coordinates-to-empty-object">
<h3>Adding coordinates to empty object<a class="headerlink" href="#adding-coordinates-to-empty-object" title="Permalink to this headline">¶</a></h3>
<p>An alternative to the direct way is to first create an empty fragment and then add the coordinate and element information later.
This can sometimes be useful and demonstrates here the built-in fragment object functions available (coords_from_string, add_coords, read_xyzfile)
First create empty fragment:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HCl_frag</span><span class="o">=</span><span class="n">Fragment</span><span class="p">()</span>
</pre></div>
</div>
<p><em>Add coordinates from string</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">fragcoords</span><span class="o">=</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">H 0.0 0.0 0.0</span>
<span class="s2">F 0.0 0.0 1.0</span>
<span class="s2">&quot;&quot;&quot;</span>
<span class="n">HCl_frag</span><span class="o">.</span><span class="n">add_coords_from_string</span><span class="p">(</span><span class="n">fragcoords</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Note:</strong> This will append coordinates to fragment. If fragment already contains some coordinates the specified coordinates
will be appended.</p>
<p><em>Add coordinates from lists</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HCl_frag</span><span class="o">.</span><span class="n">add_coords</span><span class="p">(</span><span class="n">elems</span><span class="p">,</span><span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
<p>where elems and coords are lists:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">elems</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Cl&#39;</span><span class="p">]</span>
<span class="n">coords</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">]]</span>
</pre></div>
</div>
<p><strong>Note:</strong> This will append coordinates to fragment. If fragment already contains some coordinates the added coordinates
will follow.</p>
<p><em>Add coordinates from XYZ file</em></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HF_frag</span><span class="o">.</span><span class="n">read_xyzfile</span><span class="p">(</span><span class="s2">&quot;hcl.xyz&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Note:</strong> This will append coordinates to fragment. If fragment already contains some coordinates the added coordinates
will follow.</p>
</div>
<div class="section" id="replace-coordinates-of-object">
<h3>Replace coordinates of object<a class="headerlink" href="#replace-coordinates-of-object" title="Permalink to this headline">¶</a></h3>
<p>If you want to replace coords and elems of a fragment object with new information this can be done conveniently through lists.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">elems</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;H&#39;</span><span class="p">,</span> <span class="s1">&#39;Cl&#39;</span><span class="p">]</span>
<span class="n">coords</span><span class="o">=</span><span class="p">[[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">]]</span>
<span class="n">HF_frag</span><span class="o">.</span><span class="n">replace_coords</span><span class="p">(</span><span class="n">elems</span><span class="p">,</span><span class="n">coords</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>TODO:</strong> Add option here of replacing coords from XYZ file and string as well.</p>
</div>
<div class="section" id="delete-coordinates-of-object">
<h3>Delete coordinates of object<a class="headerlink" href="#delete-coordinates-of-object" title="Permalink to this headline">¶</a></h3>
<p>If you want to delete coordinates from object (both coords list and elems lists) then this is easily done.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HF_frag</span><span class="o">.</span><span class="n">delete_coords</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="calculate-connectivity-of-fragment-object">
<h3>Calculate connectivity of fragment object<a class="headerlink" href="#calculate-connectivity-of-fragment-object" title="Permalink to this headline">¶</a></h3>
<p>Connectivity is an important aspect of the fragment as it distinguishes atoms that are in close-contact (i.e. forming some kind of stable covalent bond) and atoms further apart and obviously not bonded. Correct connectivity is crucial for some Yggdrasill functionality.
Currently, connectivity is calculated based on a distance and radii-based criterion (to be documented later).</p>
<p><span class="red">DOCUMENT BASIC CONNECTIVITY HERE</span></p>
<p>To calculate the connectivity table for a molecule:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mol_frag</span><span class="o">.</span><span class="n">calc_connectivity</span><span class="p">()</span>
</pre></div>
</div>
<p>This creates a connectivity table which is a Python list of lists:
An example of a connectivity table would be: [[0,1,2],[3,4,5],[6,7,8,9,10]]
Atoms 0,1,2 are here bonded to each other as a sub-fragment (migh e.g. be an H2O molecule) and so are atoms 3,4,5 and also 6,7,8,9,10.
The connectivity table is available as:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mol_frag</span><span class="o">.</span><span class="n">connectivity</span>
</pre></div>
</div>
<p>Note. The connectivity table is calculated or recalculated automatically when coordinates are added or when modified to the fragment.</p>
</div>
<div class="section" id="inspect-defined-fragment-objects">
<h3>Inspect defined fragment objects<a class="headerlink" href="#inspect-defined-fragment-objects" title="Permalink to this headline">¶</a></h3>
<p>To inspect a defined fragment one can print out a Python dictionary of all defined attributes of the object.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HF_frag dict&quot;</span><span class="p">,</span> <span class="n">HF_frag</span><span class="o">.</span><span class="vm">__dict__</span><span class="p">)</span>
</pre></div>
</div>
<p>One can also access individual attributes like accessing the pure coordinates only:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HF_frag.coords&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>More conveniently would be to use the print_coords function though (to print elems and coords):</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;HF_frag.print_coords&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Get coords and elems of specific atom indices:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">specific_coords</span><span class="p">,</span><span class="n">specific_elems</span><span class="o">=</span><span class="n">HF_frag</span><span class="o">.</span><span class="n">get_coords_for_atoms</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>Print connectivity:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">conn</span> <span class="o">=</span> <span class="n">FeFeH2ase</span><span class="o">.</span><span class="n">connectivity</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;conn:&quot;</span><span class="p">,</span> <span class="n">conn</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of subfragments in FeFeH2ase&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">conn</span><span class="p">))</span>
</pre></div>
</div>
<p>Print number of atoms and number of connected atoms:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of atoms in FeFeH2ase&quot;</span><span class="p">,</span> <span class="n">FeFeH2ase</span><span class="o">.</span><span class="n">numatoms</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number atoms in connectivity in FeFeH2ase&quot;</span><span class="p">,</span> <span class="n">FeFeH2ase</span><span class="o">.</span><span class="n">connected_atoms_number</span><span class="p">)</span>
</pre></div>
</div>
<p>All defined system attributed can be printed conveniently to disk:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HF_frag</span><span class="o">.</span><span class="n">print_system</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s1">&#39;fragment-info.txt&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>An XYZ file of coordinates can be printed out:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">HF_frag</span><span class="o">.</span><span class="n">write_xyzfile</span><span class="p">(</span><span class="n">xyzfilename</span><span class="o">=</span><span class="s2">&quot;Fragment-xyzfile.xyz&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="job-types.html" class="btn btn-neutral float-right" title="Job Types" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="basics.html" class="btn btn-neutral float-left" title="Basic usage" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Ragnar Bjornsson

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
    <!-- Theme Analytics -->
    <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-XXXXXXX-1', 'auto');
    ga('send', 'pageview');
    </script>

    
   

</body>
</html>